## 11. Create CI/CD Pipelines

### Day 70

#### ğŸ“Œ CI/CD íŒŒì´í”„ë¼ì¸

1. íŒŒì´í”„ë¼ì¸

âœ”ï¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë¹Œë“œ, í…ŒìŠ¤íŠ¸ ë° ë°°í¬ë¥¼ ìë™í™”í•˜ì—¬ ê°œë°œê³¼ ìš´ì˜ ê°„ì˜ ê²©ì°¨ í•´ì†Œ

2. CI/CD (ì§€ì†ì  í†µí•©/ì§€ì†ì  ë°°í¬)

âœ”ï¸ CI(ì§€ì†ì  í†µí•©): ì ì§„ì ì¸ ì½”ë“œ ë³€ê²½ì„ ë” ìì£¼, ì•ˆì •ì ìœ¼ë¡œ ìˆ˜í–‰í•˜ëŠ” ë³´ë‹¤ í˜„ëŒ€ì ì¸ ì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œ ê´€í–‰. ì§€ì†ì  í†µí•©ì— ì˜í•´ ë¦¬í¬ì§€í† ë¦¬ì— ë³‘í•©ë˜ëŠ” ì½”ë“œ ë³€ê²½ì‚¬í•­ì„ ì‹ ë¢°í•  ìˆ˜ ìˆë„ë¡ ë³´ì¥

âœ”ï¸ CD(ì§€ì†ì  ë°°í¬): CIì— ì˜í•´ ë³€ê²½ëœ ì½”ë“œ(ì• í”Œë¦¬ì¼€ì´ì…˜)ë¥¼ ì‹ ì†í•˜ê³  ì›í™œí•˜ê²Œ ì œê³µ

3. CI/CDì˜ ì¤‘ìš”ì„±

âœ”ï¸ ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ë¹ ë¥´ê³  íš¨ìœ¨ì ìœ¼ë¡œ ë°°í¬

âœ”ï¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìµœëŒ€í•œ ë¹ ë¥´ê²Œ ì‹œì¥ì— ì¶œì‹œí•˜ê¸° ìœ„í•œ íš¨ê³¼ì ì¸ í”„ë¡œì„¸ìŠ¤

âœ”ï¸ ë²„ì „ ë¦´ë¦¬ìŠ¤ë¥¼ ê¸°ë‹¤ë¦´ í•„ìš”ì—†ì´ ë²„ê·¸ ìˆ˜ì • ë° ê¸°ëŠ¥ ì¶”ê°€ê°€ ì§€ì†ì ìœ¼ë¡œ ì œê³µ

4. ì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œ ìˆ˜ëª… ì£¼ê¸° (SDLC)

âš¡ï¸ ê°œë°œìê°€ <span style="color:indianred">ì½”ë“œ</span>ë¥¼ ì‘ì„±í•˜ë©´ <span style="color:indianred">ë¹Œë“œ</span>ë˜ê±°ë‚˜ ëª¨ë‘ ì»´íŒŒì¼ë˜ê³ , ë²„ê·¸ê°€ ìˆëŠ”ì§€ <span style="color:indianred">í…ŒìŠ¤íŠ¸</span>ë˜ê³ , ìµœì¢… ì‚¬ìš©ìë‚˜ ê³ ê°ì´ ì‚¬ìš©í•˜ëŠ” í”„ë¡œë•ì…˜ì— <span style="color:indianred">ë°°í¬</span>ë˜ê³ (<span style="color:indianred">ìš´ì˜</span>), ëª¨ë‹ˆí„°ë§ ë° í”¼ë“œë°±ì„ ìˆ˜ì§‘í•˜ê³ , ë§ˆì§€ë§‰ìœ¼ë¡œ í•´ë‹¹ í”¼ë“œë°±ì„ ì¤‘ì‹¬ìœ¼ë¡œ ê°œì„  ì‚¬í•­ì„ <span style="color:indianred">ê³„íš</span>í•˜ê³  ë°˜ë³µí•˜ëŠ” ê²ƒ

![Alt text](image.png)

#### ğŸ“Œ CI

**ê°œë°œìê°€ í•˜ë£¨ì— ì—¬ëŸ¬ ë²ˆ ê³µìœ  ë¦¬í¬ì§€í† ë¦¬ì— ì½”ë“œë¥¼ í†µí•©í•´ì•¼ í•˜ëŠ” ê°œë°œ ê´€í–‰**

âœ”ï¸ ìˆœì„œ

1. ì½”ë“œê°€ ì‘ì„±ë˜ì–´ ë ˆí¬ì§€í† ë¦¬(Github ë˜ëŠ” GitLab)ì— push

![Alt text](image-1.png)

2. ìë™í™”ëœ ë¹Œë“œë¥¼ í†µí•´ ì½”ë“œê°€ ê²€ì¦ë˜ë¯€ë¡œ ë¬¸ì œ í™•ì¸ ê°€ëŠ¥

![Alt text](image-2.png)

3. ì½”ë“œ ë¶„ì„ ë° ìë™í™”ëœ í…ŒìŠ¤íŠ¸ ìˆ˜í–‰

- ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ëŠ” ì†ŒìŠ¤ ì½”ë“œì˜ ê°œë³„ ë‹¨ìœ„ë¥¼ í…ŒìŠ¤íŠ¸

- ìœ íš¨ì„± ê²€ì‚¬ í…ŒìŠ¤íŠ¸ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ê°€ ì˜ë„ëœ ìš©ë„ë¥¼ ì¶©ì¡±í•˜ê±°ë‚˜ ì í•©í•œì§€ í™•ì¸

- í˜•ì‹ í…ŒìŠ¤íŠ¸ëŠ” êµ¬ë¬¸ ë° ê¸°íƒ€ í˜•ì‹ ì§€ì • ì˜¤ë¥˜ í™•ì¸

ã„´ workflowë¡œ ìƒì„±ëœ ë§ˆìŠ¤í„° ë¸Œëœì¹˜ë¡œ pushí•  ë•Œë§ˆë‹¤ ì‹¤í–‰ë˜ê¸°ì— ìë™í™”ëœ workflowë¥¼ êµ¬ì¶•í•˜ëŠ” ê²ƒì´ íš¨ìœ¨ì 

![Alt text](image-4.png)

4. ì»´íŒŒì¼í•˜ì—¬ ë ˆí¬ì§€í† ë¦¬ë¡œ ì „ì†¡

- ë ˆí¬ì§€í† ë¦¬ëŠ” íŒŒì´í”„ë¼ì¸ì˜ CD ì¸¡ë©´ì— í™œìš©ë˜ëŠ” ëª¨ë“  ê³³ ê°€ëŠ¥

- ex. DockerHub

![Alt text](image-5.png)

ğŸ”¥ ìš”ì•½í•˜ë©´, CI í”„ë¡œì„¸ìŠ¤ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë§Œë“¤ê³ , ë²„ê·¸ í™•ì¸í•˜ê³ , ìˆ˜ì • ì´í›„ ë‹¤ìŒ ì†ŒìŠ¤ ì œì–´ë¥¼ ì—…ë°ì´íŠ¸í•˜ê³ , í…ŒìŠ¤íŠ¸í•˜ë©´ì„œ ë²„ì „ ê´€ë¦¬ ìˆ˜í–‰

#### ğŸ“Œ CD

**í…ŒìŠ¤íŠ¸ëœ ë²„ì „ì˜ ì½”ë“œ ë°°í¬**

â• ì˜¤ë¼í´ì´ë‚˜ Microsoftì™€ ê°™ì€ ê³µê¸‰ì—…ì²´ë¡œë¶€í„° ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ë°›ëŠ” ê²½ìš°, DockerHub ìœ í˜• ë ˆí¬ì§€í† ë¦¬ì—ì„œ ì†Œë¹„í•œ í›„ CD íŒŒì´í”„ë¼ì¸ì„ í†µí•´ ë°°í¬

1. ì˜¬ë°”ë¥¸ ì½”ë“œ ë² ì´ìŠ¤ë¥¼ ì˜¬ë°”ë¥¸ í™˜ê²½ì—ì„œ ê°€ì ¸ì˜¤ê³  ìˆëŠ”ì§€ í™•ì¸

![Alt text](image-6.png)

2. DockerHubì—ì„œ ì†Œí”„íŠ¸ì›¨ì–´ì˜ ìµœì‹  ë¦´ë¦¬ìŠ¤ë¥¼ ê°€ì ¸ì˜¨ í›„ í™˜ê²½ì— ë¦´ë¦¬ìŠ¤í•˜ëŠ” ë™ì‹œì— Git ë ˆí¬ì§€í† ë¦¬ì— êµ¬ì„± ê°€ì ¸ì™€ í™˜ê²½ì— push

- êµ¬ì„±ì´ ì˜¬ë°”ë¥¸ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ Staging í™˜ê²½ìœ¼ë¡œ ì´ë™í•˜ì—¬ ì´ êµ¬ì„±ì„ ì‹¤í–‰í•œ í›„ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ìˆ˜ë™ ë‹¨ê³„ or ì½”ë“œë¥¼ í”„ë¡œë•ì…˜ì— ë°°í¬í•˜ê¸° ì „ì— ë‹¤ì‹œ ìë™í™” ê°€ëŠ¥

â• ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ v2ê°€ ë‚˜ì˜¤ë©´ í•´ë‹¹ ë‹¨ê³„ë¥¼ ë°˜ë³µí•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ êµ¬ì„±ì´ Stagingì— ë°°í¬ë˜ì–´ ëª¨ë“  ê²ƒì´ ì •ìƒì¸ì§€ í™•ì¸ í›„ í”„ë¡œë•ì…˜ì— ë°°í¬

![Alt text](image-7.png)

#### ğŸ“Œ CI/CDë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ 

ğŸ”¥ ìë™í™”ë¥¼ í†µí•´ ì‘ì€ ë¬¸ì œë„ ë†“ì¹˜ì§€ ì•ŠìŒ

ğŸ”¥ ë©”ì¸ ì½”ë“œ ë ˆí¬ì§€í† ë¦¬ëŠ” ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ì§€ì†ì ìœ¼ë¡œ êµ¬ì¶•ë˜ê¸°ì— ëª‡ ë…„ í›„ ë” ë§ì€ ë¹„ìš©ì´ ë“œëŠ” ê¸°ìˆ  ë¶€ì±„ ë°©ì§€

#### ğŸ“Œ ë„êµ¬

âœ”ï¸ Jenkins

âœ”ï¸ ArgoCD

âœ”ï¸ GitHub Actions

### Day 71

#### ğŸ“Œ Jenkins

1. Jenkins

âœ”ï¸ ìƒˆë¡œ ë§Œë“  ì½”ë“œë¥¼ ì§€ì†ì ìœ¼ë¡œ ê°œë°œ, í…ŒìŠ¤íŠ¸ ë° ë°°í¬í•  ìˆ˜ ìˆëŠ” ì§€ì†ì  í†µí•© ë„êµ¬

2. ì§€ì†ì  ê°œë°œì„ ìœ„í•œ ë°©ë²•

âœ”ï¸ ê°œë°œìê°€ í•˜ë£¨ì¢…ì¼ ì‘ì—… í›„ í•˜ë£¨ê°€ ëë‚˜ë©´ ë³€ê²½ ì‚¬í•­ì„ ì†ŒìŠ¤ ì½”ë“œ ì €ì¥ì†Œì— push > ë°¤ì— ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë° ì†Œí”„íŠ¸ì›¨ì–´ ë¹Œë“œë˜ëŠ” ë°©ì‹

![Alt text](image-8.png)

âœ”ï¸ ê°œë°œìê°€ ì†ŒìŠ¤ ì½”ë“œì— ë³€ê²½ì‚¬í•­ì„ ì»¤ë°‹í•˜ê³  í•´ë‹¹ ì½”ë“œ ì»¤ë°‹ì´ ì™„ë£Œë˜ë©´ <span style="color:indianred">ë¹Œë“œ í”„ë¡œì„¸ìŠ¤ê°€ ì§€ì†ì ìœ¼ë¡œ ì‹œì‘</span>ë˜ëŠ” ë°©ì‹

![Alt text](image-9.png)

=> ì „ì„¸ê³„ì˜ ë¶„ì‚°ëœ ê°œë°œìì˜ ê²½ìš° ë§¤ì¼ ì½”ë“œ ë³€ê²½ì„ ì¤‘ë‹¨í•´ì•¼í•˜ëŠ” ì‹œê°„ì´ ì •í•´ì ¸ìˆì§€ ì•ŠìŒ. ë”°ë¼ì„œ `CI ì„œë²„ ì—­í• ì„ ìˆ˜í–‰í•˜ì—¬ í…ŒìŠ¤íŠ¸ë¥¼ ì œì–´í•˜ê³  í”„ë¡œì„¸ìŠ¤ë¥¼ êµ¬ì¶•`í•˜ëŠ” ê²ƒì´ `Jenkins`

![Alt text](image-10.png)

3. Jenkins ì´ì™¸ì˜ ì˜¤í”ˆ ì†ŒìŠ¤ ë„êµ¬

âœ”ï¸ TravisCI

âœ”ï¸ Bamboo

âœ”ï¸ Buildbot

âœ”ï¸ Apache Gump

#### ğŸ“Œ Jenkins íŠ¹ì§•

âœ”ï¸ ê°„í¸í•œ ì„¤ì¹˜

- Windows, macOS ë° Linux ìš´ì˜ ì²´ì œìš© íŒ¨í‚¤ì§€ì™€ í•¨ê»˜ ì‹¤í–‰í•  ì¤€ë¹„ê°€ ëœ ë…ë¦½í˜• ìë°” ê¸°ë°˜ í”„ë¡œê·¸ë¨

âœ”ï¸ ê°„í¸í•œ êµ¬ì„±

- ì˜¤ë¥˜ í™•ì¸ ë° ê¸°ë³¸ ì œê³µ ë„ì›€ë§ì´ í¬í•¨ëœ ì›¹ ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ ì‰½ê²Œ ì„¤ì • ë° êµ¬ì„±í•  ìˆ˜ ìˆìŒ

âœ”ï¸ í”ŒëŸ¬ê·¸ì¸

- ì—…ë°ì´íŠ¸ ì„¼í„°ì—ì„œ ë‹¤ì–‘í•œ í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©° CI/CD íˆ´ì²´ì¸ì˜ ì—¬ëŸ¬ ë„êµ¬ì™€ í†µí•©ë¨

âœ”ï¸ í™•ì¥ ê°€ëŠ¥

- ì‚¬ìš© ê°€ëŠ¥í•œ í”ŒëŸ¬ê·¸ì¸ ì™¸ì—ë„ í”ŒëŸ¬ê·¸ì¸ ì•„í‚¤í…ì²˜ë¥¼ í†µí•´ Jenkinsë¥¼ í™•ì¥í•  ìˆ˜ ìˆì–´ ê±°ì˜ ë¬´í•œí•œ ìš©ë„ë¡œ ì‚¬ìš© ê°€ëŠ¥í•œ ì˜µì…˜ ì œê³µ

âœ”ï¸ ë¶„ì‚°

- ì—¬ëŸ¬ ë¨¸ì‹ ì— ì‘ì—…ì„ ì‰½ê²Œ ë¶„ì‚°í•˜ì—¬ ì—¬ëŸ¬ í”Œë«í¼ì—ì„œ ë¹Œë“œ, í…ŒìŠ¤íŠ¸ ë° ë°°í¬ ì†ë„ë¥¼ ë†’ì¼ ìˆ˜ ìˆë„ë¡ ì§€ì›

#### ğŸ“Œ Jenkins íŒŒì´í”„ë¼ì¸

- Jenkinsì— `ì½”ë“œë¥¼ ì»¤ë°‹`í•˜ë©´ ëª¨ë“  ìë™í™”ëœ `í…ŒìŠ¤íŠ¸`ë¥¼ í†µí•´ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ `ë¹Œë“œ`í•œ ë‹¤ìŒ ê° ë‹¨ê³„ê°€ ì™„ë£Œë˜ë©´ í•´ë‹¹ ì½”ë“œë¥¼ `ë¦´ë¦¬ìŠ¤` ë° `ë°°í¬`

=> í•´ë‹¹ í”„ë¡œì„¸ìŠ¤ë¥¼ ìë™í™”í•œ ê²ƒì´ Jenkins

![Alt text](image-11.png)

#### ğŸ“Œ Jenkins ì•„í‚¤í…ì²˜

âœ”ï¸ Minikube í´ëŸ¬ìŠ¤í„° ë‚´ì— Jenkinsë¥¼ ì„¤ì¹˜í•˜ì—¬ Kubernetesì— ë°°í¬í•˜ëŠ” ê³¼ì • ì‹œë®¬ë ˆì´ì…˜

0. Jenkins ì„¤ì¹˜

- Windows, macOs, Linux ë“± ë‹¤ì–‘í•œ ìš´ì˜ì²´ì œì— ì„¤ì¹˜í•  ìˆ˜ ìˆìœ¼ë©° Docker ì»¨í…Œì´ë„ˆë¡œ ë°°í¬í•˜ê±°ë‚˜ Kubernetes ë‚´ì—ì„œ ë°°í¬í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ ì¡´ì¬

https://www.jenkins.io/doc/book/installing/

1. ê°œë°œìê°€ ì†ŒìŠ¤ ì½”ë“œ ë ˆí¬ì§€í† ë¦¬ì— ë³€ê²½ ì‚¬í•­ ì»¤ë°‹

2. Jenkinsê°€ ì •ê¸°ì ìœ¼ë¡œ ë ˆí¬ì§€í† ë¦¬ë¥¼ í™•ì¸í•˜ì—¬ ìƒˆ ì½”ë“œ ê°€ì ¸ì˜´

3. ë¹Œë“œ ì„œë²„ê°€ ì½”ë“œë¥¼ ì‹¤í–‰ íŒŒì¼ë¡œ ë¹Œë“œí•˜ë©°, ë³¸ ì˜ˆì‹œì—ì„œëŠ” ë¹Œë“œ ì„œë²„ë¡œ maven ì‚¬ìš©

4. ë¹Œë“œì— ì‹¤íŒ¨í•˜ë©´ ê°œë°œìì—ê²Œ í”¼ë“œë°± ì „ë‹¬

5. ë¹Œë“œ ì„±ê³µí•œ ê²½ìš°, JenkinsëŠ” ë¹Œë“œëœ ì•±ì„ í…ŒìŠ¤íŠ¸ ì„œë²„ì— ë°°í¬. ë³¸ ì˜ˆì‹œì—ì„œëŠ” í…ŒìŠ¤íŠ¸ ì„œë²„ë¡œ selenium ì‚¬ìš©

6. í…ŒìŠ¤íŠ¸ê°€ ì‹¤íŒ¨í•˜ë©´ ê°œë°œìì—ê²Œ í”¼ë“œë°± ì „ë‹¬

7. í…ŒìŠ¤íŠ¸ê°€ ì„±ê³µí•˜ë©´ í”„ë¡œë•ì…˜ì— ë¦´ë¦¬ìŠ¤ ê°€ëŠ¥

ğŸ”¥ ìœ„ì˜ ì£¼ê¸°ëŠ” ì—°ì†ì ì´ê¸°ì— ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ëª‡ ë¶„ë§ˆë‹¤ ì—…ë°ì´íŠ¸ ê°€ëŠ¥

![Alt text](image-12.png)

### Day 72

#### ğŸ“Œ íŒŒì´í”„ë¼ì¸

âœ”ï¸ ì•„ë˜ í”„ë¡œì„¸ìŠ¤ ë˜ëŠ” ë‹¨ê³„ë¥¼ ìë™í™”í•˜ì—¬ ìµœì¢…ì ìœ¼ë¡œ ë°°í¬ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìµœì¢… ì‚¬ìš©ìì—ê²Œ ì œê³µí•˜ëŠ” ê²°ê³¼ë¬¼ì„ ì–»ìŒ

âœ”ï¸ ìë™í™”ëœ í”„ë¡œì„¸ìŠ¤ë¥¼ í†µí•´ ì‚¬ìš©ìì— ëŒ€í•œ ë²„ì „ ê´€ë¦¬ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆìœ¼ë©° ì½”ë“œê°€ ì •ìƒì¸ì§€ í™•ì¸

âœ”ï¸ Jenkins íŒŒì´í”„ë¼ì¸ì€ Jenkins íŒŒì¼ì´ë¼ëŠ” `í…ìŠ¤íŠ¸ íŒŒì¼`ë¡œ ì‘ì„±ë˜ë©° í•´ë‹¹ íŒŒì¼ì€ ì†ŒìŠ¤ ì œì–´ ë ˆí¬ì§€í† ë¦¬ì— ì»¤ë°‹ë˜ì–´ì•¼ í•¨ => `ì½”ë“œí˜• íŒŒì´í”„ë¼ì¸`

![Alt text](image-13.png)

#### ğŸ“Œ Jenkins ë°°í¬

âœ”ï¸ Minikube ì‚¬ìš©

âœ”ï¸ ì‹¤ìŠµì— í•„ìš”í•œ ëª¨ë“  íŒŒì¼ì€ í•´ë‹¹ í´ë”ì—ì„œ í™•ì¸ ê°€ëŠ¥

https://github.com/MichaelCade/90DaysOfDevOps/tree/main/2022/Days/CICD/Jenkins

1. Minikube í´ëŸ¬ìŠ¤í„° ì‹œì‘í•˜ê³  ì‹¤í–‰

`minikube start`

2. ìœ„ì˜ í´ë”ì—ì„œ í´ëŸ¬ìŠ¤í„° ìƒì„± > jenkins ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„±

`kubectl create -f jenkins-namespace.yml`

`kubectl get ns` : namespace ì¡°íšŒ

3. Jenkins ë°°í¬ë¥¼ ìœ„í•´ Helm ì‚¬ìš©

`helm repo add jenkinsci https://charts.jenkins.io` : Jenkins ë ˆí¬ì§€í† ë¦¬ ì¶”ê°€

`helm repo update` : chart (k8s clusterì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ê¸°ë™ë˜ê¸° ìœ„í•´ í•„ìš”í•œ ëª¨ë“  ë¦¬ì†ŒìŠ¤ë“¤ì´ í¬í•¨) ì—…ë°ì´íŠ¸

> `Helm` : Kubernetes íŒ¨í‚¤ì§€ ê´€ë¦¬ (Node.jsì˜ pmp, Pythonì˜ pipê³¼ ê°™ì€ ì—­í• )

4. ì§€ì†ì„±ì„ ìœ„í•´ volume ìƒì„±

`kubectl apply -f jenkins-volume.yml`

5. ì„œë¹„ìŠ¤ ê³„ì • ìƒì„±

`kubectl apply -f jenkins-sa.yml`

6. Helm chart ì‚¬ìš©í•´ ë°°í¬

`chart=jenkinsci/jenkins` : chart ì •ì˜

`helm install jenkins -n jenkins -f jenkins-values.yml $chart` : volumeê³¼ ì„œë¹„ìŠ¤ê°€ í¬í•¨ëœ jenkins-values.yml ë°°í¬

â—ï¸ `kubectl get pods -n jenkins` : podê°€ ì´ë¯¸ì§€ë¥¼ ê°€ì ¸ì™€ì•¼ í•˜ì§€ë§Œ Jenkins ì„¤ì¹˜ë¥¼ ì‹œì‘í•  ìˆ˜ ì—†ë‹¤ëŠ” ì˜¤ë¥˜ ë°œìƒ

â­ï¸ ë¬¸ì œ í•´ê²°ì„ ìœ„í•´ ì•¡ì„¸ìŠ¤ ê¶Œí•œ ì œê³µ

`minikube ssh` : ì‹¤í–‰ ì¤‘ì¸ Minikube Docker ì»¨í…Œì´ë„ˆì— ì ‘ì†

`sudo chown -R 1000:1000 /data/jenkins-volume` : ë°ì´í„° volumeì— ëŒ€í•œ ê¶Œí•œ í™•ì¸

- ìœ„ì˜ ë°©ë²•ìœ¼ë¡œ podê°€ ìˆ˜ì •ë˜ì–´ì•¼ í•˜ì§€ë§Œ ê·¸ë ‡ì§€ ì•Šì€ ê²½ìš° `kubectl delete pod jenkins-0 -n jenkins`ë¡œ pod ê°•ì œ ìƒˆë¡œ ê³ ì¹¨

- `kubectl get pods -n jenkins` : ì‹¤í–‰ ì¤‘ì¸ podê°€ 2/2ì´ê³  ì´ë¦„ì´ jenkins-0 ì´ì–´ì•¼ í•¨

7. ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ í•„ìš”

`kubectl exec --namespace jenkins -it svc/jenkins -c jenkins -- /bin/cat /run/secrets/chart-admin-password && echo` : ë¹„ë°€ë²ˆí˜¸ ì…ë ¥

8. ìƒˆ í„°ë¯¸ë„ ì—´ì–´ ì›Œí¬ìŠ¤í…Œì´ì…˜ì— ì ‘ê·¼

ìƒˆ í„°ë¯¸ë„ì— `kubectl --namespace jenkins port-forward svc/jenkins 8080:8080` : ì›Œí¬ìŠ¤í…Œì´ì…˜ì— ì ‘ê·¼

9. ë¸Œë¼ìš°ì € ì—´ê¸°

`http://localhost:8080` : ìœ„ ë¸Œë¼ìš°ì €ì— username:adminê³¼ ì§€ì •í•œ passwordë¡œ ë¡œê·¸ì¸

âœ”ï¸ ì¸ì¦ ì™„ë£Œëœ í˜ì´ì§€ : Jenkins ë°°í¬ ì™„ë£Œ

![Alt text](image-14.png)

âœ”ï¸ Manage Jenkins > Manage Plugins > í”ŒëŸ¬ê·¸ì¸ ëª¨ë‘ ì„ íƒ í›„ Download now and install after restart

![Alt text](image-15.png)

#### ğŸ“Œ Jenkinsfile

âœ”ï¸ Jenkinsfile: íŒŒì´í”„ë¼ì¸ì˜ ë‹¨ê³„ë¥¼ ì •ì˜í•˜ëŠ” ê³³. " ë¹Œë“œ > í…ŒìŠ¤íŠ¸ > ë°°í¬ "

âœ”ï¸ í•´ë‹¹ ì„¹ì…˜ì—ì„œëŠ” ë‹¨ìˆœíˆ echo ê¸°ëŠ¥ë§Œ ì¡´ì¬í•˜ëŠ” Jenkinsfile ë°°í¬

1. Jenkins ëŒ€ì‹œë³´ë“œì—ì„œ New Item ì„ íƒ í›„ ì´ë¦„ ì§€ì • + Pipeline ì„ íƒ : ì´ë¦„ì„ echo1ìœ¼ë¡œ ì§€ì •

![Alt text](image-16.png)

- í™•ì¸ì„ ëˆ„ë¥´ë©´ íŒŒì´í”„ë¼ì¸ì—ë§Œ ê´€ì‹¬ ìˆëŠ” ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ íƒ­ í‘œì‹œ. íŒŒì´í”„ë¼ì¸ì— ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìœ¼ë©° ìŠ¤í¬ë¦½íŠ¸ ë³µì‚¬í•˜ì—¬ ìƒìì— ë¶™ì—¬ ë„£ì„ ìˆ˜ ìˆìŒ

- Jenkinsfile ì €ì¥ => íŠ¹ì • ë‹¨ê³„ í˜¸ì¶œì„ ìœ„í•´ `echo` ëª…ë ¹ ì‚¬ìš©

```
Jenkinsfile (Declarative Pipeline)

pipeline {
    agent any

    stages {
        stage('Build') {
            steps {
                echo 'Building..'
            }
        }
        stage('Test') {
            steps {
                echo 'Testing..'
            }
        }
        stage('Deploy') {
            steps {
                echo 'Deploying....'
            }
        }
    }
}

```

2. Build nowë¥¼ ì‚¬ìš©í•´ ë¹Œë“œ ì‹¤í–‰

3. í„°ë¯¸ë„ ì—´ê³  ì–´ë–¤ ì¼ì´ ë°œìƒí•˜ëŠ”ì§€ í™•ì¸

`kubectl get pods -n jenkins`

![Alt text](image-17.png)

### Day 73

#### ğŸ“Œ Jenkins ë°ëª¨ íŒŒì´í”„ë¼ì¸ êµ¬ì¶•

âœ”ï¸ ì´ì „ ì„¹ì…˜ì—ì„œëŠ” Minikube í´ëŸ¬ìŠ¤í„°ì— Jenkinsë¥¼ ë°°í¬í•˜ê³  ê¸°ë³¸ì ì¸(echoê¸°ëŠ¥ë§Œ ì¡´ì¬) Jenkins íŒŒì´í”„ë¼ì¸ ì„¤ì •

âœ”ï¸ ì•„ë˜ ê·¸ë¦¼ì—ì„œ ë³´ì´ëŠ” Declarative (Kubernetes) ë°ëª¨ ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš©

![Alt text](image-18.png)

- Declarative ë°ëª¨ ìŠ¤í¬ë¦½íŠ¸

```
// Uses Declarative syntax to run commands inside a container.
pipeline {
    agent {
        kubernetes {
            // Rather than inline YAML, in a multibranch Pipeline you could use: yamlFile 'jenkins-pod.yaml'
            // Or, to avoid YAML:
            // containerTemplate {
            //     name 'shell'
            //     image 'ubuntu'
            //     command 'sleep'
            //     args 'infinity'
            // }
            yaml '''
apiVersion: v1
kind: Pod
spec:
  containers:
  - name: shell
    image: ubuntu
    command:
    - sleep
    args:
    - infinity
'''
            // Can also wrap individual steps:
            // container('shell') {
            //     sh 'hostname'
            // }
            defaultContainer 'shell'
        }
    }
    stages {
        stage('Main') {
            steps {
                sh 'hostname'
            }
        }
    }
}
```

- ê²°ê³¼

![Alt text](image-19.png)

#### ğŸ“Œ Job ë§Œë“¤ê¸°

âœ”ï¸ ëª©í‘œ

1. ê°„ë‹¨í•œ ì•±ì„ ë§Œë“¤ì–´ GitHub ê³µìš© ë ˆí¬ì§€í† ë¦¬ì— ì €ì¥

https://github.com/scriptcamp/kubernetes-kaniko

2. Jenkinsë¥¼ ì‚¬ìš©í•˜ì—¬ Docker ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•˜ê³  DockerHubì— push (ë¹„ê³µê°œ ë ˆí¬ì§€í† ë¦¬ ì‚¬ìš©)

â• Minikubeì—ì„œ ì‹¤í–‰ ì¤‘ì´ê±°ë‚˜ Minikubeë¥¼ ì‚¬ìš©í•˜ëŠ” Kubernetes í´ëŸ¬ìŠ¤í„°ì—ì„œ í•´ë‹¹ ì‘ì—…ì„ ìˆ˜í–‰í•˜ë ¤ë©´ Kaniko ë¼ëŠ” ê²ƒì„ ì‚¬ìš©í•´ì•¼í•˜ì§€ë§Œ, ì‹¤ì œ Kubernetes í´ëŸ¬ìŠ¤í„°ì—ì„œ Jenkinsë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜ ì„œë²„ì—ì„œ ì‹¤í–‰í•˜ëŠ” ê²½ìš° ì—ì´ì „íŠ¸ë¥¼ ì§€ì •í•˜ì—¬ Docker ë¹Œë“œ ëª…ë ¹ì„ ìˆ˜í–‰í•˜ê³  ì´ë¥¼ DockerHubì— ì—…ë¡œë“œí•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ê²ƒì´ ì¼ë°˜ì 

âœ”ï¸ GitHub credentialsë¡œ Kubernetesì— ì‹œí¬ë¦¿ ë°°í¬

```
kubectl create secret docker-registry dockercred \
    --docker-server=https://index.docker.io/v1/ \
    --docker-username=<dockerhub-username> \
    --docker-password=<dockerhub-password>\
    --docker-email=<dockerhub-email>
```

#### ğŸ“Œ Jenkinsì— credentials ì¶”ê°€

âœ”ï¸ ìƒì„± ì‹œ ê²°ì •í•œ IDë¥¼ ì‚¬ìš©í•˜ì—¬ íŒŒì´í”„ë¼ì¸ì—ì„œ credentials ì°¸ì¡° ê°€ëŠ¥ + DockerHub ë° GitHubì— ëŒ€í•œ ì‚¬ìš©ì í•­ëª© ìƒì„±

1. Manage Jenkins > Manage Credentials ìƒì„±

![Alt text](image-20.png)

2. ë²”ìœ„ê°€ Jenkinsë¡œ ì„¤ì •ëœ Stores í‘œì‹œë˜ë©´ Jenkins í´ë¦­

![Alt text](image-21.png)

3. Global Credentials (unrestricted) ì„ íƒ

![Alt text](image-22.png)

4. Add Credentials

![Alt text](image-23.png)

- ê³„ì •ì— ëŒ€í•œ ì„¸ë¶€ ì •ë³´ ì…ë ¥ : `ì°¸ì¡°í•  ID ê¸°ì–µ`

- ë¹„ë°€ë²ˆí˜¸ ëŒ€ì‹  íŠ¹ì • í† í° ì•¡ì„¸ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒ ê¶Œì¥. GitHubì˜ ê²½ìš° Personal Access Token ì‚¬ìš©

![Alt text](image-24.png)

#### ğŸ“Œ íŒŒì´í”„ë¼ì¸ êµ¬ì¶•

âœ”ï¸ Kubernetes í´ëŸ¬ìŠ¤í„°ì— secretìœ¼ë¡œ ë°°í¬ëœ DockerHub credentialsë¥¼ ê°€ì§€ê³  ìˆìœ¼ë©°, ì´ credentialsë¥¼ íŒŒì´í”„ë¼ì¸ì˜ DockerHub ë‹¨ê³„ì— ë°°í¬í•˜ê¸° ìœ„í•´ í˜¸ì¶œ

1. Jenkins ëŒ€ì‹œë³´ë“œì—ì„œ New item ì„ íƒ

![Alt text](image-25.png)

2. ì´ë¦„ ì§€ì • í›„ Pipeline ì„ íƒ

![Alt text](image-26.png)

3. Pipeline íƒ­ì˜ scriptì— ì•„ë˜ ì½”ë“œ ë³µë¶™

```
podTemplate(yaml: '''
    apiVersion: v1
    kind: Pod
    spec:
      containers:
      - name: maven
        image: maven
        command:
        - sleep
        args:
        - 99d
      - name: kaniko
        image: gcr.io/kaniko-project/executor:debug
        command:
        - sleep
        args:
        - 9999999
        volumeMounts:
        - name: kaniko-secret
          mountPath: /kaniko/.docker
      restartPolicy: Never
      volumes:
      - name: kaniko-secret
        secret:
            secretName: dockercred
            items:
            - key: .dockerconfigjson
              path: config.json
''') {
  node(POD_LABEL) {
    stage('Get the project') {
      git url: 'https://github.com/scriptcamp/kubernetes-kaniko.git', branch: 'main'
      container('maven') {
        stage('Test the project') {
          sh '''
          echo pwd
          '''
        }
      }
    }

    stage('Build & Test the Docker Image') {
      container('kaniko') {
        stage('Deploy to DockerHub') {
          sh '''
            /kaniko/executor --context `pwd` --destination me1e/helloword
          '''
        }
      }
    }

  }
}
```

![Alt text](image-27.png)

4. Build now

5. DockerHubë¡œ ì´ë™í•´ ìƒˆ ë¹Œë“œê°€ ìˆëŠ”ì§€ í™•ì¸

- DockerHub ë ˆí¬ì§€í† ë¦¬ëŠ” ë¹„ê³µê°œ ë ˆí¬ì§€í† ë¦¬

### Day 74

#### ğŸ“Œ Hello World - Jenkinsfile ì•± íŒŒì´í”„ë¼ì¸

âœ”ï¸ ì´ì „ ì„¹ì…˜ì—ì„œëŠ” ê³µê°œ GitHub ë ˆí¬ì§€í† ë¦¬ì— ìˆëŠ” dockerfileì—ì„œ ë¹„ê³µê°œ Dockerhub ë ˆí¬ì§€í† ë¦¬ë¡œ docker ì´ë¯¸ì§€ë¥¼ pushí•˜ëŠ” Jenkins íŒŒì´í”„ë¼ì¸ êµ¬ì¶•

âœ”ï¸ ë³¸ ì„¹ì…˜ì—ì„œëŠ” ê°„ë‹¨í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ í†µí•´ Jenkinsfile íŒŒì´í”„ë¼ì¸ êµ¬ì¶•

âœ”ï¸ ëª©í‘œ

- Dockerfile(Hello World) / Jenkinsfile / GitHub ë ˆí¬ì§€í† ë¦¬ê°€ ì—…ë°ì´íŠ¸ë  ë•Œ íŠ¸ë¦¬ê±°í•  Jenkins íŒŒì´í”„ë¼ì¸ / GitHub ë ˆí¬ì§€í† ë¦¬ë¥¼ ì†ŒìŠ¤ë¡œ ì‚¬ìš© / Run - ë ˆí¬ì§€í† ë¦¬ ë³µì œ, ê°€ì ¸ì˜¤ê¸°, ë¹Œë“œ, í…ŒìŠ¤íŠ¸, ë°°í¬ / ì ì§„ì ì¸ ë²„ì „ ë²ˆí˜¸ë¡œ DockerHubì— ë°°í¬ / Kubernetes í´ëŸ¬ìŠ¤í„°ì— ë°°í¬í•˜ëŠ” Stretch Goal

1. GitHub ë ˆí¬ì§€í† ë¦¬ì— íŒŒì´í”„ë¼ì¸ ì†ŒìŠ¤ë¡œ ì‚¬ìš©í•˜ë˜ Jenkins íŒŒì´í”„ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€

![Alt text](image-28.png)

![Alt text](image-29.png)

2. Jenkins ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°€ì„œ ìƒˆ íŒŒì´í”„ë¼ì¸ ìƒì„±

- ì´ë•Œ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë¶™ì—¬ ë„£ëŠ” ëŒ€ì‹  "Pipeline script from SCM" ì˜µì…˜ ì‚¬ìš©

![Alt text](image-30.png)

- ì €ì¥ì„ ëˆ„ë¥´ë©´ `ìˆ˜ë™ìœ¼ë¡œ` íŒŒì´í”„ë¼ì¸ì„ ì‹¤í–‰í•˜ì—¬ DockerHub ë ˆí¬ì§€í† ë¦¬ì— ì—…ë¡œë“œëœ ìƒˆ Docker ì´ë¯¸ì§€ ë¹Œë“œ ê°€ëŠ¥

- ë ˆí¬ì§€í† ë¦¬ ë˜ëŠ” ì†ŒìŠ¤ ì½”ë“œê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ ë¹Œë“œë˜ë„ë¡ í•˜ê³  ì‹¶ì€ ê²½ìš° webhooksë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜ ì˜ˆì•½ pull ì‚¬ìš© ê°€ëŠ¥

- ê°’ë¹„ì‹¼ í´ë¼ìš°ë“œ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆê³  ì½”ë“œ ë³€ê²½ì‚¬í•­ì´ ë§ì€ ê²½ìš° ë¹„ìš©ì´ ë§ì´ ë“¤ê¸°ì—, ë°ëª¨ í™˜ê²½ì´ë¼ëŠ” ê²ƒì„ ì¸ì‹í•˜ê³  "poll scm" ì˜µì…˜ ì‚¬ìš© <- minikubeë¥¼ ì‚¬ìš©í•˜ë©´ webhooks ê¸°ëŠ¥ ë¶€ì¡±

![Alt text](image-31.png)

3. ì´ë¯¸ì§€ë¥¼ ê³µê°œ ì €ì¥ì†Œ(DockerHub)ì— ì—…ë¡œë“œí•˜ê³  ì‹¶ìŒ

- ì´ì „ ì„¹ì…˜ì—ì„œ ìƒì„±í•œ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ëª¨ë‘ ì‚­ì œ

4. Jenkinsë¡œ ëŒì•„ê°€ì„œ pipeline ìƒì„± í›„ êµ¬ì„± ì¶”ê°€ + Build now í´ë¦­

![Alt text](image-32.png)

5. DockerHub ë ˆí¬ì§€í† ë¦¬ì— 2ê°œì˜ ìƒˆ Docker ì´ë¯¸ì§€ ì¡´ì¬

![Alt text](image-33.png)

6. ê¹ƒí—ˆë¸Œ ë ˆí¬ì§€í† ë¦¬ì—ì„œ index.html íŒŒì¼ ì—…ë°ì´íŠ¸

![Alt text](image-34.png)

7. Jenkinsì—ì„œ Build now ì´í›„ DockerHubì—ì„œ í™•ì¸

- ë²„ì „ 2ì™€ ìµœì‹  íƒœê·¸ ì¡´ì¬ í™•ì¸

![Alt text](image-35.png)

â­ï¸ Kubernetes í´ëŸ¬ìŠ¤í„°ì— ì•¡ì„¸ìŠ¤ ë° ì¸ì¦ì„ í†µí•´ DockerHubë¡œ ë„ì»¤ ë¹Œë“œë¥¼ pushí•˜ëŠ” ì‹œí¬ë¦¿ ì¶”ê°€ => ë‚´ ë ˆí¬ì§€í† ë¦¬ ë° ê³„ì •ê³¼ ì—°ê²°ëœ Jenkins íŒŒì¼ ë³€ê²½ í•„ìš”

### Day 75

#### ğŸ“Œ GitHub Actions

âœ”ï¸ GitHub ActionsëŠ” íŒŒì´í”„ë¼ì¸ì˜ ë‹¤ë¥¸ ì‘ì—…ë“¤ ì‚¬ì´ì—ì„œ ë¹Œë“œ, í…ŒìŠ¤íŠ¸ ë° ë°°í¬í•  ìˆ˜ ìˆëŠ” CI/CD í”Œë«í¼. GitHub ë ˆí¬ì§€í† ë¦¬ë¥¼ ëŒ€ìƒìœ¼ë¡œ ë¹Œë“œí•˜ê³  í…ŒìŠ¤íŠ¸í•˜ëŠ” `Wolkflow` ê°œë… ì¡´ì¬ => GitHub Actionsë¥¼ ì‚¬ìš©í•˜ì—¬ ë¦¬í¬ì§€í† ë¦¬ ë‚´ì—ì„œ ë°œìƒí•˜ëŠ” Eventë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë‹¤ë¥¸ Wolkflow êµ¬ë™ ê°€ëŠ¥

1. Wolkflow

âœ”ï¸ ì „ë°˜ì ìœ¼ë¡œ GitHub Actionsì—ì„œ ì‘ì—…ì„ ë¶€ë¥´ëŠ” ì´ë¦„

- êµ¬ì„± ê°€ëŠ¥í•œ ìë™í™”ëœ í”„ë¡œì„¸ìŠ¤

- YAML íŒŒì¼ë¡œ ì •ì˜

- í•˜ë‚˜ ì´ìƒì˜ `Job`ì„ í¬í•¨í•˜ê³  ì‹¤í–‰

- ë ˆí¬ì§€í† ë¦¬ì˜ `Event`ì— ì˜í•´ íŠ¸ë¦¬ê±°ë  ë•Œ ì‹¤í–‰ë˜ê±°ë‚˜ ìˆ˜ë™ìœ¼ë¡œ ì‹¤í–‰ ê°€ëŠ¥

- ë ˆí¬ì§€í† ë¦¬ ë‹¹ ì—¬ëŸ¬ wolkflow ì‚¬ìš© ê°€ëŠ¥

- Wolkflowì—ëŠ” Jobê³¼ í•´ë‹¹ Jobì„ ë‹¬ì„±í•˜ê¸° ìœ„í•œ `Step` í¬í•¨

- Wolkflow ë‚´ì—ëŠ” Wolkflowê°€ ì‹¤í–‰ë˜ëŠ” `Runner` ì¡´ì¬

âœ”ï¸ ex. PRì„ ë¹Œë“œí•˜ê³  í…ŒìŠ¤íŠ¸í•˜ëŠ” Wolkflow, ë¦´ë¦¬ìŠ¤ê°€ ë§Œë“¤ì–´ì§ˆ ë•Œë§ˆë‹¤ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°í¬í•˜ëŠ” Wolkflow, ëˆ„êµ°ê°€ ìƒˆ issueë¥¼ ì—´ ë•Œë§ˆë‹¤ ë ˆì´ë¸”ì„ ì¶”ê°€í•˜ëŠ” Wolkflow ë“±

2. Event

âœ”ï¸ Wolkflowë¥¼ ì‹¤í–‰í•˜ë„ë¡ íŠ¸ë¦¬ê±°í•˜ëŠ” ë ˆí¬ì§€í† ë¦¬ì˜ íŠ¹ì • ì´ë²¤íŠ¸

3. Job

âœ”ï¸ Runnerì—ì„œ ì‹¤í–‰ë˜ëŠ” Wolkflowì˜ Step ì§‘í•©

4. Step

âœ”ï¸ Job ë‚´ì˜ ê° stepì€ ì‹¤í–‰ë˜ëŠ” shell ìŠ¤í¬ë¦½íŠ¸ ë˜ëŠ” Actionì´ ë  ìˆ˜ ìˆê³  ìˆœì„œëŒ€ë¡œ ì‹¤í–‰ë˜ë©° ì„œë¡œ ì¢…ì†ì 

5. Action

âœ”ï¸ ìì£¼ ë°˜ë³µë˜ëŠ” ì‘ì—…ì—ëŠ” ë°˜ë³µ ê°€ëŠ¥í•œ ì‚¬ìš©ì ì§€ì • ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‚¬ìš©ë¨

6. Runner

âœ”ï¸ Wolkflowë¥¼ ì‹¤í–‰í•˜ëŠ” ì„œë²„ë¡œ, ê° RunnerëŠ” í•œ ë²ˆì— í•˜ë‚˜ì˜ ì‘ì—… ì‹¤í–‰

âœ”ï¸ GitHub ActionsëŠ” Ubuntu Linux, Microsoft Windows ë° macOS Runnerë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìœ¼ë©° íŠ¹ì • OS ë˜ëŠ” í•˜ë“œì›¨ì–´ì—ì„œ ì§ì ‘ í˜¸ìŠ¤íŒ… ê°€ëŠ¥

âœ”ï¸ Wolkflow íŠ¸ë¦¬ê±°í•˜ëŠ” Event > Wolkflowê°€ ë‘ ê°œì˜ Jobìœ¼ë¡œ êµ¬ì„± > Job ë‚´ì˜ Stepê³¼ Action

![Alt text](image-36.png)

7. YAML

âœ”ï¸ ìœ„ì˜ ì´ë¯¸ì§€ë¥¼ YAML íŒŒì¼ë¡œ ë³€í™˜

```
#Workflow
name: 90DaysOfDevOps
#Event
on: [push]
#Jobs
jobs:
  check-bats-version:
    #Runner
    runs-on: ubuntu-latest
    #Steps
    steps:
        #Actions
      - uses: actions/checkout@v2
      - uses: actions/setup-node@v2
        with:
          node-version: '14'
      - run: npm install -g bats
      - run: bats -v
```

#### ğŸ“Œ GitHub Actions ì‹¤ìŠµ : ì½”ë“œ lintì— GitHub Actions ì‚¬ìš©

âœ”ï¸ `GitHub/super-linter` ì‚¬ìš©í•´ ì½”ë“œ í™•ì¸

```
name: Super-Linter

on: push

jobs:
  super-lint:
    name: Lint code base
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Run Super-Linter
        uses: github/super-linter@v3
        env:
          DEFAULT_BRANCH: main
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
```

â­ï¸ Wolkflowì—ì„œ í™˜ê²½ ë³€ìˆ˜ `GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}` ì „ë‹¬. GitHub Secretì€ GitHubì—ì„œ ìë™ìœ¼ë¡œ ì„¤ì •í•˜ë¯€ë¡œ ì„¤ì •í•  í•„ìš”ê°€ ì—†ìœ¼ë©°, Actionìœ¼ë¡œ ì „ë‹¬í•˜ê¸°ë§Œ í•˜ë©´ ë¨

1. í…ŒìŠ¤íŠ¸í•  ë ˆí¬ì§€í† ë¦¬ëŠ” Jenkins ë°ëª¨ì—ì„œ ì‚¬ìš©í•œ ë ˆí¬ì§€í† ë¦¬

![Alt text](image-37.png)

2. ë ˆí¬ì§€í† ë¦¬ì— ìƒˆ íŒŒì¼ ìƒì„±

â• Actionsë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ Actions íƒ­ì„ ì‚¬ìš©í•˜ì—¬ ë§ˆì¼“í”Œë ˆì´ìŠ¤ì—ì„œ ì„ íƒí•˜ê±°ë‚˜ ìœ„ì˜ super-linter ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ íŒŒì¼ ìƒì„±í•´ì•¼ í•¨

`.github/workflows/super-linter.yml` ì´ë¦„ì˜ íŒŒì¼ì— ë°”ë¡œ ìœ„ì˜ ì½”ë“œ ë³µë¶™ í›„ ì»¤ë°‹

![Alt text](image-38.png)

3. ì»¤ë°‹ í›„ Actions íƒ­ìœ¼ë¡œ ì´ë™

- super-linter Wolkflow í‘œì‹œ

- ì½”ë“œì—ì„œ ë ˆí¬ì§€í† ë¦¬ì— ë¬´ì–¸ê°€ë¥¼ pushí•  ë•Œ Wolkflowê°€ ì‹¤í–‰ë˜ë„ë¡ ì •ì˜í–ˆê¸°ì— Wolkflowê°€ íŠ¸ë¦¬ê±° ë˜ì§€ë§Œ ì˜¤ë¥˜ ë°œìƒ

=> super-linterì˜ ë²„ì „ì„ 3ì—ì„œ 4ë¡œ ë³€ê²½ í›„ ë‹¤ì‹œ ì‹¤í–‰

![Alt text](image-39.png)

- ì„±ê³µ

![Alt text](image-40.png)

### Day 76

#### ğŸ“Œ ArgoCD

**Argo CDëŠ” Kubernetesë¥¼ ìœ„í•œ ì„ ì–¸ì  GitOps ì§€ì†ì  ë°°í¬ ë„êµ¬ì…ë‹ˆë‹¤**

âœ”ï¸ minikube kubernetes í´ëŸ¬ìŠ¤í„°ë¥¼ ë‹¤ì‹œ ë¡œì»¬ë¡œ ì‚¬ìš©í•´ ArgoCD ë°°í¬

```
kubectl create namespace argocd
kubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml
```

âœ”ï¸ `kubectl get pods -n argocd`ë¡œ ArgoCD podê°€ ì‹¤í–‰ë˜ê³  ìˆëŠ”ì§€ í™•ì¸

âœ”ï¸ `kubectl get all -n argocd`ë¡œ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ë°°í¬í•œ ëª¨ë“  ê²ƒ í™•ì¸

âœ”ï¸ ìœ„ì˜ ë‚´ìš©ì´ ì •ìƒì ìœ¼ë¡œ ë³´ì´ë©´ í¬íŠ¸ í¬ì›Œë“œë¥¼ í†µí•´ ì ‘ê·¼

- ìƒˆ í„°ë¯¸ë„ì— `kubectl port-forward svc/argocd-server -n argocd 8080:443` ëª…ë ¹ ì‚¬ìš© í›„ ì›¹ë¸Œë¼ìš°ì €ì— `https://localhost:8080` ì…ë ¥

âœ”ï¸ ë¡œê·¸ì¸ì„ ìœ„í•´ ì‚¬ìš©ì ì´ë¦„ê³¼ ë¹„ë°€ë²ˆí˜¸ ì‚¬ìš©

- `kubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath="{.data.password}" | base64 -d && echo`

âœ”ï¸ ë¡œê·¸ì¸ ì™„ë£Œ í˜ì´ì§€

![Alt text](image-41.png)

## 12. Monitoring, Log Management, and Data Visualization

### Day 77

#### ğŸ“Œ ëª¨ë‹ˆí„°ë§

1. ëª¨ë‹ˆí„°ë§

âœ”ï¸ ì „ì²´ ì¸í”„ë¼ë¥¼ ë©´ë°€íˆ ì£¼ì‹œí•˜ëŠ” í”„ë¡œì„¸ìŠ¤

2. í•„ìš”ì„±

âœ”ï¸ ì„œë²„ì˜ ëª¨ë“  ì„œë¹„ìŠ¤, ì• í”Œë¦¬ì¼€ì´ì…˜, ë¦¬ì†ŒìŠ¤ê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ê³  ìˆëŠ”ì§€ í™•ì¸í•  ì±…ì„ì´ ìˆìŒ

3. ëª¨ë‹ˆí„°ë§ ë°©ë²•

âœ”ï¸ ëª¨ë“  ì„œë²„ì— ìˆ˜ë™ìœ¼ë¡œ ë¡œê·¸ì¸í•˜ì—¬ ì„œë¹„ìŠ¤ í”„ë¡œì„¸ìŠ¤ ë° ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ëª¨ë“  ë°ì´í„° í™•ì¸

âœ”ï¸ ìš°ë¦¬ë¥¼ ëŒ€ì‹ í•˜ì—¬ ì„œë²„ì— ë¡œê·¸ì¸í•˜ê³  ë°ì´í„°ë¥¼ í™•ì¸í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±

âœ”ï¸ ì‹œì¤‘ì— ë‚˜ì™€ìˆëŠ” ëª¨ë‹ˆí„°ë§ ì†”ë£¨ì…˜ ì‚¬ìš© ex. Nagios, Zabbix

#### ğŸ“Œ Nagios

âœ”ï¸ NagiosëŠ” ì¸í”„ë¼ ëª¨ë‹ˆí„°ë§ ë„êµ¬ë¡œ, ì„œë²„ë¥¼ ëª¨ë‹ˆí„°ë§í•˜ê³  ì„œë²„ì™€ ì„œë¹„ìŠ¤, ì¸í”„ë¼ê°€ ì¶©ë¶„íˆ í™œìš©ë˜ê³  ìˆëŠ”ì§€ ë˜ëŠ” í•´ê²°í•´ì•¼ í•  ì¥ì•  ì‘ì—…ì´ ìˆëŠ”ì§€ í™•ì¸ ê°€ëŠ¥

âœ”ï¸ ë””ìŠ¤í¬ ë˜ëŠ” ì„œë²„ê°€ ìœ„í—˜í•œ ìƒíƒœì— ìˆì„ ë•Œ ê²½ê³ í•˜ì—¬ ì„œë¹„ìŠ¤ ì¤‘ë‹¨ì„ í”¼í•˜ê¸° ìœ„í•œ ì ì ˆí•œ ì¡°ì¹˜ë¥¼ ì·¨í•  ìˆ˜ ìˆë„ë¡ ì•Œë ¤ì¤Œ

#### ğŸ“Œ ì§€ì†ì ì¸ ëª¨ë‹ˆí„°ë§

âœ”ï¸ ëª¨ë‹ˆí„°ë§ê³¼ ê´€ë ¨í•œ ì£¼ìš” ì˜ì—­: ì¸í”„ë¼ ëª¨ë‹ˆí„°ë§, ì• í”Œë¦¬ì¼€ì´ì…˜ ëª¨ë‹ˆí„°ë§, ë„¤íŠ¸ì›Œí¬ ëª¨ë‹ˆí„°ë§

### Day 78

âœ”ï¸ `Prometheus` ì‚¬ìš©í•´ ëª¨ë‹ˆí„°ë§

#### ğŸ“Œ Prometheus

1. Prometheus

âœ”ï¸ ì»¨í…Œì´ë„ˆì™€ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ê¸°ë°˜ ì‹œìŠ¤í…œë¿ë§Œ ì•„ë‹ˆë¼ ë¬¼ë¦¬ì , ê°€ìƒ ë° ê¸°íƒ€ ì„œë¹„ìŠ¤ë¥¼ ëª¨ë‹ˆí„°ë§í•˜ëŠ” ë° ë„ì›€ì´ ë˜ëŠ” ì˜¤í”ˆì†ŒìŠ¤

âœ”ï¸ ì—¬ëŸ¬ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ ì§€ì›

2. pull ì ‘ê·¼ ë°©ì‹

âœ”ï¸ ìˆ˜ì²œ ê°œì˜ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ë˜ëŠ” ì‹œìŠ¤í…œ ë° ì„œë¹„ìŠ¤ì™€ ëŒ€í™”í•˜ëŠ” ê²½ìš° push ë°©ì‹ì€ ì¼ë°˜ì ìœ¼ë¡œ ì„œë¹„ìŠ¤ê°€ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œìœ¼ë¡œ pushí•˜ëŠ”ë°, ë„¤íŠ¸ì›Œí¬ ê³¼ë¶€í•˜, ë†’ì€ CPU ì‚¬ìš©ëŸ‰, ë‹¨ì¼ ì¥ì•  ì§€ì  ë“±ì˜ ë¬¸ì œ ë°œìƒ

âœ”ï¸ pull ë°©ì‹ì€ ëª¨ë“  ì„œë¹„ìŠ¤ì˜ ë©”íŠ¸ë¦­ ì—”ë“œí¬ì¸íŠ¸ì—ì„œ Prometheusê°€ ëŒì–´ì˜´

3. Prometheusì˜ êµ¬ì„±ì„ ìœ„í•œ YAML

âœ”ï¸ Kubernetesì— ë°°í¬ë˜ì—ˆì„ ë•Œ ì‘ì—…/exporterë¡œë¶€í„° ë©”íŠ¸ë¦­ì„ ê°€ì ¸ì˜¤ëŠ” `PushGateway`

âœ”ï¸ ì•Œë¦¼ì„ pushí•˜ëŠ” `AlertManager` => ì™¸ë¶€ ì„œë¹„ìŠ¤(ì´ë©”ì¼,ìŠ¬ë™ ë“±)ì™€ í†µí•©

âœ”ï¸ PushGatewayì—ì„œ pull ë©”íŠ¸ë¦­ì˜ ê²€ìƒ‰ì„ ê´€ë¦¬í•˜ê³  push ì•Œë¦¼ì„ AlertManagerë¡œ ì „ì†¡í•˜ëŠ” `Prometheus Server` => ë¡œì»¬ ë””ìŠ¤í¬ì— ë°ì´í„° ì €ì¥

âœ”ï¸ ë©”íŠ¸ë¦­ê³¼ ìƒí˜¸ ì‘ìš©í•˜ëŠ”ë° ì‚¬ìš©ë˜ëŠ” `PromQL`

![Alt text](image-42.png)

#### ğŸ“Œ Prometheus ë°°í¬ ë°©ë²•

âœ”ï¸ êµ¬ì„± YAML íŒŒì¼ ìƒì„±

âœ”ï¸ ì˜¤í¼ë ˆì´í„° ì‚¬ìš© (ëª¨ë“  Prometheus êµ¬ì„± ìš”ì†Œì˜ ê´€ë¦¬ì)

âœ”ï¸ Helm ì°¨íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜¤í¼ë ˆì´í„° ë°°í¬

#### ğŸ“Œ Kubernetesì— ë°°í¬

âœ”ï¸ ë¡œì»¬ì—ì„œ minikube í´ëŸ¬ìŠ¤í„° ì‚¬ìš© + Helm ì‚¬ìš©í•´ Prometheus Helm ì°¨íŠ¸ ë°°í¬

1. Prometheus Helm ì°¨íŠ¸ ë°°í¬

`helm repo add prometheus-community https://prometheus-community.github.io/helm-charts`

`helm repo update` : Helm ë ˆí¬ì§€í† ë¦¬ ì—…ë°ì´íŠ¸

`helm repo list`

2. minikube í™˜ê²½ì— Prometheus ë°°í¬

`helm install stable prometheus-community/prometheus`

`kubectl get pods` : (ì¼ì • ì‹œê°„ í›„) pod ìƒì„± í™•ì¸

`kubectl get all` : ëª¨ë“  pod ì‹¤í–‰ë˜ë©´ Prometheusì˜ ë°°í¬ëœ ì¸¡ë©´ ì¡°íšŒ ê°€ëŠ¥

3. Prometheus Server UIì— ì•¡ì„¸ìŠ¤í•˜ê¸° ìœ„í•´ í¬íŠ¸ í¬ì›Œë”©

`export POD_NAME=$(kubectl get pods --namespace default -l "app=prometheus,component=server" -o jsonpath="{.items[0].metadata.name}")
  kubectl --namespace default port-forward $POD_NAME 9090`

4. ë¸Œë¼ìš°ì € ì—´ê¸°

`http://localhost:9090`

![Alt text](image-43.png)

- `container_cpu_usage_seconds_total`ì„ í†µí•´ PromQLì„ ì‚¬ìš©í•˜ì—¬ ë©”íŠ¸ë¦­ ìº¡ì²˜ í™•ì¸

![Alt text](image-44.png)

### Day 79

#### ğŸ“Œ ë¡œê·¸ ê´€ë¦¬ ë° ì§‘ê³„

âœ”ï¸ ë¡œê·¸ ì§‘ê³„ë€ ë‹¤ì–‘í•œ ì„œë¹„ìŠ¤ì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸ë¥¼ ìˆ˜ì§‘í•˜ê³  íƒœê·¸ë¥¼ ì§€ì •í•˜ì—¬ ì‰½ê²Œ ê²€ìƒ‰í•  ìˆ˜ ìˆëŠ” ë‹¨ì¼ ëŒ€ì‹œë³´ë“œì— ì €ì¥í•˜ëŠ” ë°©ë²•

âœ”ï¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„±ëŠ¥ ê´€ë¦¬ ì‹œìŠ¤í…œì—ì„œ ê°€ì¥ ë¨¼ì € êµ¬ì¶•í•´ì•¼í•˜ëŠ” ì‹œìŠ¤í…œ ì¤‘ í•˜ë‚˜

#### ğŸ“Œ ì˜ˆì œ ì•±

âœ”ï¸ ì›¹ ì•±ìœ¼ë¡œ, ì¼ë°˜ì ì¸ í”„ë¡ íŠ¸ì—”ë“œì™€ ë°±ì—”ë“œê°€ ì¤‘ìš”í•œ ë°ì´í„°ë¥¼ MongoDB ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥

âœ”ï¸ ì‚¬ìš©ìê°€ í˜ì´ì§€ê°€ ëª¨ë‘ í•˜ì–—ê²Œ ë³€í•˜ê³  ì˜¤ë¥˜ ë©”ì„¸ì§€ê°€ ì¸ì‡„ë˜ì—ˆë‹¤ê³  ë§í•˜ë©´ í˜„ì¬ ìŠ¤íƒì˜ ë¬¸ì œë¥¼ ì§„ë‹¨í•˜ê¸° ìœ„í•´ ì‚¬ìš©ìê°€ ìˆ˜ë™ìœ¼ë¡œ ì˜¤ë¥˜ë¥¼ ë³´ë‚´ì•¼í•˜ê³  ë‹¤ë¥¸ ì„¸ ê°€ì§€ ì„œë¹„ìŠ¤ì˜ ê´€ë ¨ ë¡œê·¸ì™€ ì¼ì¹˜ì‹œì¼œì•¼ í•¨

#### ğŸ“Œ Elk

âœ”ï¸ ì„¸ ê°€ì§€ êµ¬ì„± ìš”ì†Œì¸ Elasticsearch, Logstash, Kibanaì˜ ì´ë¦„ì„ ë”´ ì˜¤í”ˆ ì†ŒìŠ¤ ë¡œê·¸ ì§‘ê³„ ìŠ¤íƒ

1. êµ¬ì„± ìš”ì†Œ

âœ”ï¸ ëª¨ë“  ì„œë¹„ìŠ¤ê°€ Logstashë¡œ ë¡œê·¸ë¥¼ ì „ì†¡í•˜ê³ , LogstashëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë°©ì¶œí•˜ëŠ” í…ìŠ¤íŠ¸ì¸ ë¡œê·¸ë¥¼ ê°€ì ¸ì˜´

âœ”ï¸ LogstashëŠ” ë¡œê·¸ ë©”ì„¸ì§€ì—ì„œ ì‚¬ìš©ìê°€ ì–¸ì œ ë¬´ì—‡ì„ í–ˆëŠ”ì§€ ì¶”ì¶œí•˜ê³  ì´ë¥¼ íƒœê·¸ë¡œ í¬í•¨ì‹œì¼œ í…ìŠ¤íŠ¸ ì¿¼ë¦¬ DBì¸ Elasticsearchì— ì €ì¥

âœ”ï¸ ElasticsearchëŠ” Kibanaë¡œ ê²°ê³¼ë¥¼ ë…¸ì¶œí•˜ê³  KibanaëŠ” Elasticsearchì— ì—°ê²°í•˜ëŠ” ì›¹ ì„œë²„ë¡œ ê°œë°œìë‚˜ ê´€ë¦¬ìë¥¼ í—ˆìš©

âœ”ï¸ ê´€ë¦¬ìëŠ” Kibanaì— ì—°ê²°í•˜ê³ , KibanaëŠ” ì‚¬ìš©ìê°€ ì›í•˜ëŠ” ê²ƒê³¼ ì¼ì¹˜í•˜ëŠ” ë¡œê·¸ë¥¼ ì°¾ê¸° ìœ„í•´ Elasticsearchë¥¼ ì¿¼ë¦¬

2. Elkë¥¼ ì‚¬ìš©í•´ í”„ë¡œë•ì…˜ ë¬¸ì œ ì§„ë‹¨ ë°©ë²•

âœ”ï¸ ì˜¤ë¥˜ ì½”ë“œë¥¼ ê²€ìƒ‰ ì°½ì— ì…ë ¥í•˜ë©´ í•´ë‹¹ ë¡œê·¸ê°€ í‘œì‹œë˜ê³ , ê·¸ ë¡œê·¸ë¥¼ ìƒì„±í•œ ì„œë¹„ìŠ¤ê°€ ë¡œê·¸ë¥¼ ìƒì„±í•œ ë°±ì—”ë“œì´ê³ , í•´ë‹¹ ë¡œê·¸ê°€ ìƒì„±ëœ ì‹œê°„ì˜ ë°±ì—”ë“œ ë©”ì„¸ì§€ í™•ì¸í•˜ì—¬ ì›ì¸ ì°¾ì„ ìˆ˜ ìˆìŒ

3. ë³´ì•ˆ ë° ë¡œê·¸ ì•¡ì„¸ìŠ¤

âœ”ï¸ ë¡œê·¸ëŠ” ê´€ë¦¬ìì—ê²Œë§Œ í‘œì‹œë˜ë„ë¡ í•´ì•¼í•¨

#### ğŸ“Œ ë¡œê·¸ ê´€ë¦¬ ë„êµ¬ì˜ ì˜ˆ

- Elasticsearch

- Logstash

- Kibana

- Fluentd

- Datadog

- LogDNA

- Splunk

### Day 80

#### ğŸ“Œ ELK ìŠ¤íƒ

1. Elasticsearch

âœ”ï¸ ëª¨ë“  ìœ í˜•ì˜ ë°ì´í„°ë¥¼ ìœ„í•œ ë¶„ì‚°í˜• ë¬´ë£Œ ê°œë°©í˜• ê²€ìƒ‰ ë° ë¶„ì„ ì—”ì§„

2. Logstash

âœ”ï¸ ë‹¤ì–‘í•œ ì†ŒìŠ¤ì—ì„œ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ê³  ë³€í™˜í•œ ë‹¤ìŒ ì›í•˜ëŠ” ì €ì¥ì†Œ(stash)ë¡œ ì „ì†¡í•˜ëŠ” ë¬´ë£Œ ê°œë°©í˜• ì„œë²„ì¸¡ ë°ì´í„° ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸

3. Kibana

âœ”ï¸ ë¬´ë£Œ ê°œë°©í˜• ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ë¡œ, Elasticsearch ë°ì´í„°ë¥¼ ì‹œê°í™”í•˜ê³  Elastic Stackì„ íƒìƒ‰í•  ìˆ˜ ìˆê²Œ í•´ì¤Œ

âœ”ï¸ ì¿¼ë¦¬ ë¡œë“œ ì¶”ì ê³¼ ì•±ì—ì„œ ìš”ì²­ì´ íë¥´ëŠ” ë°©ì‹ ì´í•´ ê°€ëŠ¥

#### ğŸ“Œ ELK ìŠ¤íƒ ê³¼ì •

1. Log : ë¶„ì„í•´ì•¼ í•˜ëŠ” ì„œë²„ ë¡œê·¸ ì‹ë³„

2. Logstash : ë¡œê·¸ì™€ ì´ë²¤íŠ¸ ë°ì´í„° ìˆ˜ì§‘. ë°ì´í„° êµ¬ë¬¸ ë¶„ì„ ë° ë³€í™˜ ê°€ëŠ¥

3. ElasticSearch : Logstashì—ì„œ ë³€í™˜ëœ ë°ì´í„°ëŠ” ì €ì¥, ê²€ìƒ‰ ë° ìƒ‰ì¸ ê°€ëŠ¥

4. Kibana : Elasticsearch DBë¥¼ ì‚¬ìš©í•´ íƒìƒ‰, ì‹œê°í™”, ê³µìœ 

![Alt text](image-45.png)

### Day 81

#### ğŸ“Œ Fluentd & FluentBit

âœ”ï¸ Fluentd : ë°ì´í„° ìˆ˜ì§‘ê¸°. ê¹¨ë—í•˜ê³  ì•ˆì •ì ì¸ ë¡œê¹… íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•˜ëŠ” ë° ì í•©í•œ 4ê°€ì§€ ì£¼ìš” ê¸°ëŠ¥ ì¡´ì¬

- JSONì„ ì‚¬ìš©í•œ í†µí•© ë¡œê¹… : ê°€ëŠ¥í•œ ë°ì´í„°ë¥¼ JSONìœ¼ë¡œ êµ¬ì¡°í™”í•˜ë ¤ ë…¸ë ¥. ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆëŠ” ì¶©ë¶„í•œ êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆê¸°ì— JSON ì‚¬ìš©í•˜ë©´ ë‹¤ìš´ìŠ¤íŠ¸ë¦¼ ë°ì´í„° ì²˜ë¦¬ê°€ ì‰¬ì›Œì§

- í”ŒëŸ¬ê·¸ ê°€ëŠ¥í•œ ì•„í‚¤í…ì²˜ : ê¸°ëŠ¥ì„ í™•ì¥í•  ìˆ˜ ìˆëŠ” ìœ ì—°í•œ í”ŒëŸ¬ê·¸ì¸ ì‹œìŠ¤í…œì„ ê°–ì¶° ë¡œê·¸ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ í™œìš© ê°€ëŠ¥

- ìµœì†Œí•œì˜ ë¦¬ì†ŒìŠ¤ í•„ìš” : ë°ì´í„° ìˆ˜ì§‘ê¸°ëŠ” ë°”ìœ ì»´í“¨í„°ì—ì„œë„ í¸ì•ˆí•˜ê²Œ ì‹¤í–‰ë˜ì–´ì•¼ í•˜ë¯€ë¡œ ê°€ë²¼ì›Œì•¼í•¨

- ë‚´ì¥ëœ ì•ˆì •ì„± : ë°ì´í„° ì†ì‹¤ì€ ì ˆëŒ€ ì¼ì–´ë‚˜ì§€ ì•Šì•„ì•¼ í•¨

#### ğŸ“Œ ì•±ì´ ë°ì´í„°ë¥¼ ê¸°ë¡í•˜ëŠ” ë²•

âœ”ï¸ íŒŒì¼ì— ê¸°ë¡ `.log` íŒŒì¼

âœ”ï¸ ë°ì´í„°ë² ì´ìŠ¤ì— ì§ì ‘ ê¸°ë¡

âœ”ï¸ íƒ€ì‚¬ ì• í”Œë¦¬ì¼€ì´ì…˜ (NodeJS, NGINX, PostgreSQL)

âš¡ï¸ FluentDëŠ” ìœ„ì˜ 3ê°€ì§€ ë¡œê¹… ë°ì´í„° ìœ í˜•ì„ í—ˆìš©í•˜ê³  ìˆ˜ì§‘, ì²˜ë¦¬í•˜ì—¬ ëŒ€ìƒ(Elastic, MongoDB, Kafka DB)ìœ¼ë¡œ ë¡œê·¸ë¥¼ ì „ì†¡í•˜ëŠ” ê¸°ëŠ¥ ì œê³µ

âš¡ï¸ Fluentdì™€ FluentBitëŠ” ì…ë ¥ í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ FluentBit í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•œ ë‹¤ìŒ, ì¶œë ¥ í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•˜ì—¬ ElasticSearchì™€ ê°™ì€ ì¶œë ¥ ëŒ€ìƒì´ ë¬´ì—‡ì´ë“  ì¶œë ¥ ê°€ëŠ¥

#### ğŸ“Œ Kubernetesì˜ FluentBit

âœ”ï¸ Kubernetesì˜ FluentBitëŠ” ë°ëª¬ì…‹ìœ¼ë¡œ ë°°í¬ë˜ë©°, ì´ëŠ” í´ëŸ¬ìŠ¤í„°ì˜ ê° ë…¸ë“œì—ì„œ ì‹¤í–‰ë¨ì„ ì˜ë¯¸ => ê° ë…¸ë“œì˜ FluentBit podëŠ” í•´ë‹¹ ë…¸ë“œì˜ ì»¨í…Œì´ë„ˆë¥¼ ì½ê³  ëª¨ë“  ë¡œê·¸ ìˆ˜ì§‘

1. Fluent Helm ë ˆí¬ì§€í† ë¦¬ì— ë°°í¬

`helm repo add fluent https://fluent.github.io/helm-charts`

`helm install fluent-bit fluent/fluent-bit` : ì„¤ì¹˜

2. fluent-bit podê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸

`kubectl get all | grep fluent` : ì‹¤í–‰ ì¤‘ì¸ pod, ì„œë¹„ìŠ¤ ë° ë°ëª¬ì…‹ í™•ì¸

3. FluentBitì´ ë¡œê·¸ë¥¼ ì–´ë””ì—ì„œ ê°€ì ¸ì˜¬ì§€ ì•Œ ìˆ˜ ìˆëŠ” êµ¬ì„± íŒŒì¼ì´ ìˆìœ¼ë©°, ì´ì™€ ìœ ì‚¬í•œ ê²ƒì´ configmap

`kubectl get configmap` : configmap í™•ì¸

4. podë¥¼ í¬íŠ¸ í¬ì›Œë”©í•´ ì—°ê²°ì„± í™•ë³´

`kubectl get pods | grep fluent`ìœ¼ë¡œ pod ì´ë¦„ ê°€ì ¸ì™€ì„œ `kubectl port-forward [podì´ë¦„] 2020:2020`

5. `http://localhost:2020/`ë¡œ ì›¹ë¸Œë¼ìš°ì € ì—´ê¸°

### Day 82

#### ğŸ“Œ EFK ìŠ¤íƒ ì†Œí”„íŠ¸ì›¨ì–´

âœ”ï¸ ì´ì „ ì„¹ì…˜ì—ì„œëŠ” ë¡œê·¸ ìˆ˜ì§‘ê¸°ë¡œ Logstashë¥¼ ì‚¬ìš©í•˜ëŠ” ELK ìŠ¤íƒì´ì—ˆê³ , ì´ë²ˆ ì„¹ì…˜ì—ëŠ” FluentD ë˜ëŠ” FluentBitë¥¼ ì‚¬ìš©í•˜ëŠ” EFK ìŠ¤íƒ

1. Elasticsearch

- NoSQL ë°ì´í„°ë² ì´ìŠ¤ëŠ” ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ”ë° ì‚¬ìš©ë˜ë©° ê²€ìƒ‰ ë° ë¡œê·¸ ì¿¼ë¦¬ë¥¼ ìœ„í•œ ì¸í„°í˜ì´ìŠ¤ ì œê³µ

2. Fluentd

- í†µí•© ë¡œê¹… ê³„ì¸µì„ ìœ„í•œ ì˜¤í”ˆ ì†ŒìŠ¤ ë°ì´í„° ìˆ˜ì§‘ê¸°ë¡œ, ë°ì´í„° ìˆ˜ì§‘ê³¼ ì†Œë¹„ë¥¼ í†µí•©í•˜ì—¬ ë°ì´í„°ë¥¼ ë” ì˜ ì‚¬ìš©í•˜ê³  ì´í•´í•  ìˆ˜ ìˆìŒ

3. Kibana

- ë¡œê·¸ ê´€ë¦¬ ë° í†µê³„ë¥¼ ìœ„í•œ ì¸í„°í˜ì´ìŠ¤ë¡œ elasticsearchì—ì„œ ì •ë³´ë¥¼ ì½ëŠ” ì—­í• 

![Alt text](image-46.png)

#### ğŸ“Œ minikubeì— EFK ë°°í¬

âœ”ï¸ minikube í´ëŸ¬ìŠ¤í„°ë¥¼ ì‚¬ìš©í•´ EFK ë°°í¬

1. `minikube start`ë¥¼ ì‚¬ìš©í•´ í´ëŸ¬ìŠ¤í„° ì‹œì‘ => WSL2ê°€ í™œì„±í™”ëœ Windows OS ì‚¬ìš©

2. EFK ìŠ¤íƒì„ í´ëŸ¬ìŠ¤í„°ì— ë°°í¬í•˜ëŠ” ë° í•„ìš”í•œ yml íŒŒì¼(ì•„ë˜ ë§í¬) ìƒì„±

https://github.com/MichaelCade/90DaysOfDevOps/blob/main/2022/Days/Monitoring/EFK%20Stack/efk-stack.yaml

- ì´í›„ `kubectl create -f efk-stack.yaml`ìœ¼ë¡œ ë°°í¬

3. `kubectl get pods -n kube-logging -w`ì„ í†µí•´ ì§„í–‰ ìƒí™© í™•ì¸

4. `kubectl get pods -n kube-logging`ì„ í†µí•´ ëª¨ë“  podê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸

- ElasticSearchì™€ ì—°ê²°ëœ 3ê°œì˜ pod / Fluentdì™€ ì—°ê²°ëœ pod 1ê°œ / Kibanaì™€ ì—°ê²°ëœ pod 1ê°œ í™•ì¸

5. `kubectl get all -n kube-logging`ì„ ì‚¬ìš©í•´ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ í‘œì‹œ

- fluentdëŠ” ë°ëª¬ì…‹ìœ¼ë¡œ ë°°í¬ë˜ê³ , kibanaëŠ” deploymentë¡œ, elasticsearchëŠ” statefulsetìœ¼ë¡œ ë°°í¬

6. ìƒˆ í„°ë¯¸ë„ì— `kubectl port-forward kibana-84cf7f59c-v2l8v 5601:5601 -n kube-logging` ëª…ë ¹ì–´ ì‹¤í–‰í•˜ì—¬ í¬íŠ¸ í¬ì›Œë”© ë° kibana ëŒ€ì‹œë³´ë“œ ì•¡ì„¸ìŠ¤

7. ë¸Œë¼ìš°ì €ì—ì„œ `http://localhost:5601` ì´ë™

- ì™¼ìª½ ë©”ë‰´ì˜ discover íƒ­ ëˆ„ë¥´ê³  Index patternì— \* ì¶”ê°€ > next step

![Alt text](image-47.png)

- Time Filter field nameì—ì„œ @timestamp ì˜µì…˜ ì„ íƒ > create index pattern

![Alt text](image-48.png)

- discover íƒ­ìœ¼ë¡œ ë“¤ì–´ê°€ë©´ ë°ì´í„°ê°€ ë“¤ì–´ì˜¤ëŠ” ê²ƒ í™•ì¸ ê°€ëŠ¥

![Alt text](image-49.png)

### Day 83

#### ğŸ“Œ ë°ì´í„° ì‹œê°í™” - Grafana

1. Kibana

âœ”ï¸ Kibanaì˜ í•µì‹¬ ê¸°ëŠ¥ì€ ë°ì´í„° ì¿¼ë¦¬ ë° ë¶„ì„ìœ¼ë¡œ, ì‚¬ìš©ìëŠ” ë°ì´í„° ë‚´ì˜ íŠ¹ì • ì´ë²¤íŠ¸ë‚˜ ë¬¸ìì—´ì— ëŒ€í•´ Elasticsearchì—ì„œ ìƒ‰ì¸ëœ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•  ìˆ˜ ìˆìŒ

âœ”ï¸ ì¿¼ë¦¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë‹¤ì–‘í•œ ë°©ì‹ìœ¼ë¡œ ë°ì´í„° ì‹œê°í™”

2. Grafana

âœ”ï¸ ì¼ë°˜ì ìœ¼ë¡œ Prometheusì™€ Grafanaë¥¼ í•¨ê»˜ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆì§€ë§Œ, Elasticsearch ë° Graphiteì™€ í•¨ê»˜ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ë„ ì¡´ì¬

â­ï¸ KibanaëŠ” Elasticsearch ìœ„ì—ì„œ ì‹¤í–‰ë˜ë©° ì£¼ë¡œ ë¡œê·¸ ë©”ì„¸ì§€ ë¶„ì„ì— ì‚¬ìš©ë˜ê³ , GrafanaëŠ” ì‹œìŠ¤í…œ CPU, ë©”ëª¨ë¦¬, ë””ìŠ¤í¬ ë° I/O ì‚¬ìš©ë¥ ê³¼ ê°™ì€ ë©”íŠ¸ë¦­ì„ ë¶„ì„í•˜ê³  ì‹œê°í™”ì— ì í•©

â­ï¸ Kibanaì™€ Grafana ëª¨ë‘ ë°°í¬ê°€ ì‰½ê³  ë°°í¬ ìœ„ì¹˜ë¥¼ ì„ íƒí•  ìˆ˜ ìˆìœ¼ë©°, Linux, Mac, Windows, Dockerì— ì„¤ì¹˜í•˜ê±°ë‚˜ ì†ŒìŠ¤ì—ì„œ ë¹Œë“œí•˜ëŠ” ê²ƒì„ ì§€ì›

#### ğŸ“Œ Prometheus Operator + Grafana Deployment

âœ”ï¸ Grafanaê°€ Prometheus ë°ì´í„°ë² ì´ìŠ¤ì— ìˆ˜ì§‘ ë° ì €ì¥ëœ ë©”íŠ¸ë¦­ì˜ ëŒ€í™”í˜• ì‹œê°í™” ì œê³µ => ì‚¬ìš©ì ì •ì˜ ì°¨íŠ¸, ê·¸ë˜í”„ ë° ì•Œë¦¼ì„ ë§Œë“¤ ìˆ˜ ìˆìŒ

âœ”ï¸ minikube í´ëŸ¬ìŠ¤í„° ì‚¬ìš©

1. ë¡œì»¬ ì‹œìŠ¤í…œì— ë³µì œ

`git clone https://github.com/prometheus-operator/kube-prometheus.git`

`cd kube-prometheus`

2. minikube í´ëŸ¬ìŠ¤í„° ë‚´ì— ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„±

`kubectl create -f manifests/setup`

3. ë°ëª¨ì— í•„ìš”í•œ ëª¨ë“  ê²ƒ ë°°í¬

`kubectl create -f manifests/`

4. podê°€ ì‹¤í–‰ë  ë•Œê¹Œì§€ ëŒ€ê¸° ë° ê°ì‹œ

`kubectl get pods -n monitoring -w`

5. ëª¨ë‘ ì‹¤í–‰ ì¤‘ì´ë©´ ëª¨ë“  podê°€ ì •ìƒ ìƒíƒœì¸ì§€ í™•ì¸

`kubectl get pods -n monitoring`

6. ì„œë¹„ìŠ¤ ë°°í¬ í™•ì¸

`kubectl get svc -n monitoring`

7. ë°°í¬ëœ ëª¨ë“  ë¦¬ì†ŒìŠ¤ í™•ì¸

`kubectl get all -n monitoring`

8. ìƒˆ í„°ë¯¸ë„ì— `kubectl --namespace monitoring port-forward svc/grafana 3000`ë¡œ í¬íŠ¸í¬ì›Œë”©

9. ë¸Œë¼ìš°ì € `http://localhost:3000`ë¡œ ì´ë™

- ê¸°ë³¸ ì‚¬ìš©ì ì´ë¦„ê³¼ ë¹„ë°€ë²ˆí˜¸

```
Username: admin
Password: admin
```

10. `kubectl --namespace monitoring port-forward svc/prometheus-k8s 9090`ë¡œ prometheus í¬íŒ… > Add your first data source í´ë¦­ í›„ Prometheus ì„ íƒ

- `http://localhost:9090`ë¡œ ì£¼ì†Œ ë³€ê²½ > save&test í´ë¦­

11. í™ˆí˜ì´ì§€ì—ì„œ create your first dashboard > Add a new panel ì„ íƒ > Data sourceì— Prometheus-1 ì„ íƒ > metricìœ¼ë¡œ `cluster:node_cpu:ratio{}` ì…ë ¥(í´ëŸ¬ìŠ¤í„° ë…¸ë“œì— ëŒ€í•œ ì„¸ë¶€ ì •ë³´ ì œê³µí•˜ê³  í†µí•©ì´ ì‘ë™í•˜ê³  ìˆìŒì„ ì¦ëª…)

#### ğŸ“Œ ì•Œë¦¼

âœ”ï¸ ë°°í¬í•œ ì•Œë¦¼ ê´€ë¦¬ìë¥¼ í™œìš©í•˜ì—¬ ìŠ¬ë™ì´ë‚˜ ë‹¤ë¥¸ í†µí•©ìœ¼ë¡œ ì•Œë¦¼ ì „ì†¡ ê°€ëŠ¥

=> `kubectl --namespace monitoring port-forward svc/alertmanager-main 9093 http://localhost:9093`ë¡œ í¬íŠ¸ í¬ì›Œë”©

### week4 TMI

### Pull ì ‘ê·¼ ë°©ì‹ê³¼ Push ì ‘ê·¼ ë°©ì‹

1. Push ë°©ì‹

âœ”ï¸ ê° ì„œë²„ì— í´ë¼ì´ì–¸íŠ¸ë¥¼ ì„¤ì¹˜í•˜ê³  ì´ í´ë¼ì´ì–¸íŠ¸ê°€ ë©”íŠ¸ë¦­ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•´ì„œ ì„œë²„ë¡œ ë³´ë‚´ë©´ ì„œë²„ê°€ ëª¨ë‹ˆí„°ë§ ìƒíƒœë¥¼ ë³´ì—¬ì£¼ëŠ” ë°©ì‹

2. Pull ë°©ì‹

âœ”ï¸ ì„œë²„ì— í´ë¼ì´ì–¸íŠ¸ê°€ ë– ìˆìœ¼ë©´ ì„œë²„ê°€ ì£¼ê¸°ì ìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸ì— ì ‘ì†í•´ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë°©ì‹
